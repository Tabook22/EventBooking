{% extends 'ahome.html' %}
{% load static %}
{% block title %}
Galler List
{% endblock title %}

{% block content %}
<h1>Manage Gallery Collections</h1>
<div class="container">

    <div class="row">
        <form id="post-form" method="POST" action="{% url 'manage-Gallery' %}">
            {% csrf_token %}
            <div style="display:flex; justify-content:center;align-items: center;flex-direction: row;">
                <select id="selevent" name="selevent" class="form-select" aria-label="Default select example">
                    <option selected disabled value="0">Please select an event</option>
                    {% for img in evn_list %}
                    <option value="{{ img.name }}">{{img.name}}</option>
                    {% endfor %}
                </select>
                <button type="submit" id="submit-all" class="btn btn-outline-secondary btn-lg" style="width:10rem;">
                    Select Event</button>
            </div>


        </form>
    </div>
</div>
<br />
<div class="container">
    <div class="row" style="padding-bottom:10px;">
        <div style="display:flex; justify-content:center;align-items: center;flex-direction: row;">
            <a href="#" id="deleteall" class="btn btn-danger btn-lg"
                style="width:10rem;margin-right:20px;">Delete all</a>
            <button type="button" id="deleteselected" class="btn btn-outline-secondary btn-lg" style="width:12rem;">
                Delete selected</button>
        </div>

        


        <div id="delete_message">
            <h2>Are You Sure You Want To Delete This</h2>
            <input href="{% url 'delete-all' getname %}" type="button" value="Delete event" id="delete">
            <input type="button" value="Cancel" id="cancel">
        </div>


    </div>
    <div class="row">
        <div id="envinfo" class="alert alert-light" role="alert">{{collname}}</div>
    </div>

    <div id="allimg" class="row">
        {% for img in img_list %}
        {% if img.event_image %}

        <div class="card"
            style="padding:10px;width: 18rem; display:flex;justify-content:center;align-items: center;flex-direction: column;">
            <img src="{{ img.event_image.url }}" class="card-img-top" alt="{{ img.name }}"
                style="width:120px;height:125px;">
            <div
                style="margin-top:5px;border-top:1px solid gray;width:100%;display:flex;justify-content:center;align-items: center; ">
                <input type="checkbox" class="form-check-input" value="img.id" />
            </div>

        </div>
        {% endif %}
        {% endfor %}
    </div>
</div>

<!-- Check the submite button-->
<script type="text/javascript">
    //change the value of the dropdown options, because the delete will not work if the selected value is the first one
    $(document).ready(function () {
        $('#selevent option[value="{{getname}}"]').attr('selected', 'selected');

    });
    $('#post-form').submit(function (e) {
        var selev = $('#selevent option:selected').val();
        $('#allimg').empty(); //clear all images
        $('#envinfo').empty(); // clear gallery event information
        //e.preventDefault(); 
        if (selev == 0) {
            e.preventDefault(); //stop form from submitting
            $('#envinfo').append('<span style="color:red;">Sorry!. Please Select the Gallery Event </span>');
        }

        // do ajax now
        //console.log("In the name of Allah"); 
    });

    //check if the page is fully loaded,if so check the getname variable is it empty or not
    //check for Navigation Timing API support


    //if delete all is clicked we want to make sure the user selected an image gallery collection to be fully deleted
    $('#deleteall').on('click', function (e) {
       
        //get the selected option
        var selev = $('#selevent option:selected').val()
        //if the selected value is the first value in the selection menue then abort
        if (selev == 0) {
            e.preventDefault(); //stop form from submitting
            $('#envinfo').empty();
            $('#envinfo').append('<span style="color:red;">Sorry!. Please Select the Gallery Event </span>');
        }
        $("#delete_message").slideDown();
        

        //$("#delete").on('click',function(){ 
        //    hide();
       // });
        $("#cancel").click(function () {
            e.preventDefault(); //stop form from submitting
            hide();
        });
        //if(!confirm("Do you want to really delete this?")) {
        //    return false;
        //}
    });



    function hide() {
        $("#delete_message").slideUp();

    }
</script>

<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- LightBox css -->
<link rel="stylesheet" type="text/css" href="{% static 'lightbox2-2.11.3/dist/css/lightbox.min.css' %}" />
<!-- LightBox Js -->
<script type="text/javascript" src="{% static 'lightbox2-2.11.3/dist/js/lightbox.min.js' %}"></script>


{% endblock content %}